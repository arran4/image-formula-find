# Image Formula Find

This project uses a Genetic Algorithm to find mathematical formulas that generate an image approximating a target image. The formulas are evolved over generations to minimize the difference between the generated image and the target image.

## How it works

The "DNA" of an individual in the population consists of three encoded strings representing mathematical formulas for the Red, Green, and Blue color channels. These formulas are parsed and evaluated for each pixel (X, Y) to determine the color.

The evolution process involves:
1.  **Selection**: The best performing formulas (closest to target) are selected.
2.  **Crossover**: DNA from parents is combined to create children.
3.  **Mutation**: DNA is randomly mutated (insertions, deletions, shifts, etc.).

## Binaries

*   **`mutateAndSelect`**: The main evolutionary engine. It runs the genetic algorithm, logs progress to `out.csv`, and periodically saves the best result to `out.png`.
*   **`watchMutateAndSelect`**: A graphical version that visualizes the evolution process in real-time using Ebiten.
*   **`draw1`**: Utility to draw an image from a given formula.

## Usage

### Running the evolution (Headless)

```bash
go run ./cmd/mutateAndSelect
```

This will load `in5.png` (hardcoded currently) and start the evolution. It will produce `out.png` and `out.csv`.

### Running with Visualization

```bash
go run ./cmd/watchMutateAndSelect
```

This requires a display (or X11 forwarding) as it opens a window to show the current best approximations.

## Examples

### Target Image (`in5.png`)

![Target Image](in5.png)

### Evolution Result (Example)

After running the algorithm for some generations, it produces an approximation like `out.png`.

*(Note: `out.png` is generated by running the program)*

### Evolution Process (GIF)

Here is a time-lapse of the evolution process:

![Evolution Process](evolution.gif)

## Status

The project is functional. It includes a parser for the custom formula language, a genetic algorithm implementation, and visualization tools.

## DNA Language & Features

The DNA string encodes formulas for Red, Green, and Blue channels.

### Coordinate System
Input coordinates (X, Y) are scaled to a view window of **[-10, 10]** regardless of the image resolution.
- `X`: -10 (left) to 10 (right)
- `Y`: -10 (top) to 10 (bottom)

### Constant Generation
The parser supports generating constants of varying magnitudes using specific trigger characters:

| Character | Exponent | Multiplier | Example DNA | Result Value |
| :--- | :--- | :--- | :--- | :--- |
| `A` | $10^0$ | 1 | `ABA` | 64 |
| `Q` | $10^1$ | 10 | `QBA` | 640 |
| `g` | $10^2$ | 100 | `gBA` | 6400 |
| `w` | $10^{-1}$ | 0.1 | `wBA` | 6.4 |
| `/` | $10^{-2}$ | 0.01 | `/BA` | 0.64 |

This allows the evolution to easily access both very small precision values and large scalars.
